@startuml

title US12 - Minimal Backbone Network (Technical Sequence Diagram)

participant MinimalBackboneUI as UI
participant MinimalBackboneController as Controller
participant MinimalBackboneService as Service
participant Graph as Graph
participant MapGraph as Backbone
participant GraphvizExporter as Exporter

UI -> Controller : requestMinimalBackbone(graph)
activate Controller

Controller -> Service : computeMinimalBackbone(graph)
activate Service

alt graph is null OR graph has no vertices
    Service --> Controller : empty backbone
    deactivate Service
    Controller --> UI : showError("Graph is empty")
    deactivate Controller
    return
end

Service -> Graph : vertices()
Graph --> Service : allVertices

Service -> Service : selectInitialVertex()
Service -> Backbone : createUndirectedGraph()
activate Backbone

Service -> Backbone : addVertex(initialVertex)

loop while backbone.size < graph.vertices.size
    Service -> Service : findMinimumConnectingEdge()

    loop for each vertex in backbone
        Service -> Graph : outgoingEdges(vertex)
        Graph --> Service : edges

        loop for each edge
            alt edge connects to non-backbone vertex
                Service -> Service : compare edge weight
                Service -> Service : update minimum edge
            else
                Service -> Service : ignore edge
            end
        end
    end

    alt minimum edge found
        Service -> Backbone : addVertex(newVertex)
        Service -> Backbone : addEdge(v1, v2, weight)
    else
        break
    end
end

Service --> Controller : backboneGraph
deactivate Service

Controller -> Exporter : exportUndirectedBackbone(backboneGraph, "backbone.dot")
activate Exporter
Exporter --> Controller : DOT file created
deactivate Exporter

Controller --> UI : backboneGraph
Controller --> UI : DOT file
Controller --> UI : timeComplexity(O(V Ã— E))
deactivate Controller

UI -> UI : runGraphviz(neato)
UI -> UI : generateSVG()

@enduml
